{
    "openapi": "3.0.0",
    "info": {
        "title": "Carsharing",
        "description": "Документация к API системы каршеринга",
        "version": "1.0"
    },
    "paths": {
        "/api/bills/{id}/set/status/": {
            "post": {
                "tags": [
                    "Счета"
                ],
                "summary": "Изменить статус счета",
                "description": "Изменяет статус выбранного счета",
                "operationId": "681e33b286470feeecb43ced8046a134",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор Счета",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": "1"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/BillSetStatusRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Возвращает измененный счет"
                    },
                    "404": {
                        "description": "Счет по заданному идентификатору не найден"
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе или счет уже имеет запрашиваемый статус",
                        "content": {
                            "application/json": {
                                "schema": {},
                                "example": {
                                    "error": "Bill already has 'open' status"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/rents/get": {
            "get": {
                "tags": [
                    "Аренда"
                ],
                "summary": "Получить аренду",
                "description": "Получить запись об аренде по идентификатору",
                "operationId": "acef5cced65fcd25fdbde7579ba8a3cd",
                "parameters": [
                    {
                        "name": "rentId",
                        "in": "query",
                        "description": "Идентификатор аренды",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": "1"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Возвращает запись аренды"
                    },
                    "404": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        },
        "/api/rents/get/status/{id}": {
            "get": {
                "tags": [
                    "Аренда"
                ],
                "summary": "Получить статус аренды",
                "description": "Получить статус аренды по идентификатору",
                "operationId": "0c902b493366778884dcf9c5cacdd255",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор аренды",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": "1"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Возвращает статус аренды",
                        "content": {
                            "application/json": {
                                "schema": {},
                                "example": {
                                    "status": "closed"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Неверно передан идентификатор"
                    }
                }
            }
        },
        "/api/rents/get/open": {
            "get": {
                "tags": [
                    "Аренда"
                ],
                "summary": "Получить открытые аренды",
                "description": "Получить аренды со статусом 'открытая'",
                "operationId": "b8721de47a711a5660598649762e6f69",
                "responses": {
                    "200": {
                        "description": "Возвращает список аренд"
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        },
        "/api/rents/get/close": {
            "get": {
                "tags": [
                    "Аренда"
                ],
                "summary": "Получить закрытые аренды",
                "description": "Получить аренды со статусом 'закрытая'",
                "operationId": "d138eae810b0670b91e50cb7896163c8",
                "responses": {
                    "200": {
                        "description": "Возвращает список аренд"
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        },
        "/api/rents/open": {
            "post": {
                "tags": [
                    "Аренда"
                ],
                "summary": "Открыть аренду",
                "description": "Взять машину в аренду для заданного пользователя и открыть аренду",
                "operationId": "3176259ed0e7874716f8aa2de3e72d8a",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/RentOpenRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Возвращает запись созданной аренды"
                    },
                    "403": {
                        "description": "Статус пользователя или ТС не позволяет открыть аренду"
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        },
        "/api/rents/close": {
            "get": {
                "tags": [
                    "Аренда"
                ],
                "summary": "Закрыть аренду",
                "description": "Закрыть аренду по идентификатору",
                "operationId": "dec0209c65dff4087e6583b60e6839d0",
                "parameters": [
                    {
                        "name": "rentId",
                        "in": "query",
                        "description": "Идентификатор аренды",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": "1"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Возвращает запись закрытой аренды"
                    },
                    "403": {
                        "description": "Статус аренды или статус ТС не позволяет закрыть аренду"
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        },
        "/api/renters/set/defaultbill": {
            "get": {
                "tags": [
                    "Пользователи"
                ],
                "summary": "Изменить счет по умолчанию",
                "description": "Изменяет выбранный по умолчанию счет для конкретного пользователя",
                "operationId": "529b241002479562e3320b8469ae3949",
                "parameters": [
                    {
                        "name": "renterId",
                        "in": "query",
                        "description": "Идентификатор пользователя",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": "1"
                        }
                    },
                    {
                        "name": "billId",
                        "in": "query",
                        "description": "Идентификатор счета",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": "1"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Возвращает пользователя"
                    },
                    "400": {
                        "description": "Статус счета не позволяет выбрать его основным",
                        "content": {
                            "application/json": {
                                "schema": {},
                                "example": {
                                    "error": "Bill with status 'blocked' cannot be selected as the default bill"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе или произошла ошибка при изменении статуса счета",
                        "content": {
                            "application/json": {
                                "schema": {},
                                "example": {
                                    "error": "Renter has not bill with id '1'"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/vehicles/brands": {
            "get": {
                "tags": [
                    "Бренды ТС"
                ],
                "summary": "Получить все бренды ТС",
                "description": "Получить список всех брендов ТС",
                "operationId": "52089cbec2ade682b178c30d683246b7",
                "responses": {
                    "200": {
                        "description": "Возвращает список брендов ТС"
                    }
                }
            },
            "post": {
                "tags": [
                    "Бренды ТС"
                ],
                "summary": "Создать бренд ТС",
                "description": "Создает новый бренд ТС и возвращает его",
                "operationId": "19d322b2dfd986c9c04dc16d952c3cdb",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "vehicle_manufacturer_id": {
                                        "type": "integer",
                                        "example": "1"
                                    },
                                    "name": {
                                        "type": "string",
                                        "example": "Audi"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Возвращает запись созданного бренда ТС",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/VehicleBrandResourse"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        },
        "/api/vehicles/brands/{id}": {
            "get": {
                "tags": [
                    "Бренды ТС"
                ],
                "summary": "Получить бренд",
                "description": "Получает бренд ТС по идентификатору и возвращает его",
                "operationId": "22efb00a5abe9eaf2230dc71fd5c657a",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор бренда ТС",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Возвращает запись бренда ТС",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/VehicleBrandResourse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Не найдено"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Бренды ТС"
                ],
                "summary": "Удалить бренд",
                "description": "Удаляет запись о бренде ТС. Важно! Удаление бренда приведет к удалению ВСЕХ связанных моделей и ТС",
                "operationId": "18e3cd63db8bdfdc6bf134fb35f3fa5c",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор бренда ТС",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Возвращает сообщение об успешном удалении",
                        "content": {
                            "application/json": {
                                "schema": {},
                                "example": {
                                    "message": "Succesfully deleted"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Не найдено"
                    }
                }
            },
            "patch": {
                "tags": [
                    "Бренды ТС"
                ],
                "summary": "Обновить бренд ТС",
                "description": "Обновляет запись о бренде ТС и возвращает ее",
                "operationId": "bb928c7c29ff0436b3840dca2c331647",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор бренда",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "vehicle_manufacturer_id": {
                                        "type": "integer",
                                        "example": "1"
                                    },
                                    "name": {
                                        "type": "string",
                                        "example": "Audi"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Возвращает запись бренда ТС",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/VehicleBrandResourse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Не найдено"
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        },
        "/api/vehicles/": {
            "get": {
                "tags": [
                    "ТС"
                ],
                "summary": "Получить все ТС",
                "description": "Получить список ТС",
                "operationId": "b430f89e14ef2ecbccbc97555596c220",
                "responses": {
                    "200": {
                        "description": "Возвращает список ТС"
                    }
                }
            },
            "post": {
                "tags": [
                    "ТС"
                ],
                "summary": "Создать ТС",
                "description": "Создает новое ТС и возвращает ее",
                "operationId": "3374dda446c2715f7929be3603278693",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/VehicleCreateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Возвращает запись созданного ТС",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/VehicleResourse"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        },
        "/api/vehicles/{id}": {
            "get": {
                "tags": [
                    "ТС"
                ],
                "summary": "Получить ТС",
                "description": "Получает ТС по идентификатору и возвращает его",
                "operationId": "0185374b4b707b85ca8a97a6f5f366e1",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор ТС",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "format": "uuid",
                            "example": "989bd621-3b30-4932-a507-803672fae71d"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Возвращает запись ТС",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/VehicleResourse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "ТС не найдено"
                    }
                }
            },
            "delete": {
                "tags": [
                    "ТС"
                ],
                "summary": "Удалить ТС",
                "description": "Удаляет запись о ТС",
                "operationId": "3442f99c22f47affb335443ef012e712",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор ТС",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "format": "uuid",
                            "example": "989bd621-3b30-4932-a507-803672fae71d"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Возвращает сообщение об успешном удалении",
                        "content": {
                            "application/json": {
                                "schema": {},
                                "example": {
                                    "message": "Succesfully deleted"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Неверно передан идентификатор ТС"
                    }
                }
            },
            "patch": {
                "tags": [
                    "ТС"
                ],
                "summary": "Обновить ТС",
                "description": "Обновляет запись о ТС и возвращает ее",
                "operationId": "c8cf5f0cacef168664d0a731533e0ef9",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор ТС",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "format": "uuid",
                            "example": "989bd621-3b30-4932-a507-803672fae71d"
                        }
                    }
                ],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/VehicleUpdateRequest"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Возвращает запись ТС",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/VehicleResourse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Неверно передан идентификатор ТС"
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        },
        "/api/vehicles/manufacturers": {
            "get": {
                "tags": [
                    "Производители ТС"
                ],
                "summary": "Получить всех производителей ТС",
                "description": "Получить список всех производителей ТС",
                "operationId": "d354ea79ba545a7baca1b310b8954446",
                "responses": {
                    "200": {
                        "description": "Возвращает список производителей ТС"
                    }
                }
            },
            "post": {
                "tags": [
                    "Производители ТС"
                ],
                "summary": "Создать производителя ТС",
                "description": "Создает нового производителя ТС и возвращает его",
                "operationId": "990b27e7c495a6652cef9743ff69c3a5",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "VAG"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Возвращает запись созданного производителя ТС",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/VehicleManufacturerResourse"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        },
        "/api/vehicles/manufacturers/{id}": {
            "get": {
                "tags": [
                    "Производители ТС"
                ],
                "summary": "Получить производителя",
                "description": "Получает производителя ТС по идентификатору и возвращает его",
                "operationId": "b363e8fa34f1f6dfa90ec579a1a7fecd",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор производителя ТС",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Возвращает запись производителя ТС",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/VehicleManufacturerResourse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Не найдено"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Производители ТС"
                ],
                "summary": "Удалить производителя",
                "description": "Удаляет запись о производителе ТС. Важно! Удаление производителя приведет к удалению ВСЕХ связанных моделей, брендов и ТС",
                "operationId": "95af64c263e297725b22c177b7f606bb",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор производителя ТС",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Возвращает сообщение об успешном удалении",
                        "content": {
                            "application/json": {
                                "schema": {},
                                "example": {
                                    "message": "Succesfully deleted"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Неверно передан идентификатор производителя ТС"
                    }
                }
            },
            "patch": {
                "tags": [
                    "Производители ТС"
                ],
                "summary": "Обновить производителя ТС",
                "description": "Обновляет запись о производителе ТС и возвращает ее",
                "operationId": "5cd9d619f4378d9159eecde40d684ce5",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "Идентификатор производителя",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "VAG"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Возвращает запись производителя ТС",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/VehicleManufacturerResourse"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Не найдено"
                    },
                    "422": {
                        "description": "Неверно переданы данные в запросе"
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "BillSetStatusRequest": {
                "properties": {
                    "status": {
                        "description": "Статус",
                        "type": "string",
                        "example": "open"
                    }
                },
                "type": "object"
            },
            "Rent/CloseRequest": {
                "properties": {
                    "rentId": {
                        "description": "Идентификатор аренды",
                        "type": "integer",
                        "example": "1"
                    }
                },
                "type": "object"
            },
            "RentOpenRequest": {
                "properties": {
                    "renterId": {
                        "description": "Идентификатор пользователя",
                        "type": "integer",
                        "example": "1"
                    },
                    "vehicleId": {
                        "description": "Идентификатор ТС",
                        "type": "integer",
                        "example": "1"
                    }
                },
                "type": "object"
            },
            "Bill/SetDefaultBillRequest": {
                "properties": {
                    "renterId": {
                        "description": "Идентификатор пользователя",
                        "type": "integer",
                        "example": "1"
                    },
                    "billId": {
                        "description": "Идентификатор счета",
                        "type": "integer",
                        "example": "1"
                    }
                },
                "type": "object"
            },
            "VehicleCreateRequest": {
                "properties": {
                    "vehicle_model_id": {
                        "description": "Идентификатор модели ТС",
                        "type": "integer",
                        "example": "1"
                    },
                    "status": {
                        "description": "Статус ТС",
                        "type": "string",
                        "example": "maintenance"
                    },
                    "mileage": {
                        "description": "Пробег ТС",
                        "type": "integer",
                        "example": "4300"
                    },
                    "manufacture_year": {
                        "description": "Год производства ТС",
                        "type": "integer",
                        "example": "2010"
                    },
                    "location": {
                        "description": "Координаты ТС",
                        "type": "string",
                        "example": "-41.201 -59.8371"
                    },
                    "license_plate": {
                        "description": "Гос. Номер ТС",
                        "type": "string",
                        "example": "А999МР 179"
                    },
                    "price_at_minute": {
                        "description": "Цена в копейках за минуту аренды ТС",
                        "type": "integer",
                        "example": "400000"
                    }
                },
                "type": "object"
            },
            "VehicleUpdateRequest": {
                "properties": {
                    "vehicle_model_id": {
                        "description": "Идентификатор модели ТС",
                        "type": "integer",
                        "example": "1"
                    },
                    "status": {
                        "description": "Статус ТС",
                        "type": "string",
                        "example": "maintenance"
                    },
                    "mileage": {
                        "description": "Пробег ТС",
                        "type": "integer",
                        "example": "4300"
                    },
                    "manufacture_year": {
                        "description": "Год производства ТС",
                        "type": "integer",
                        "example": "2010"
                    },
                    "location": {
                        "description": "Координаты ТС",
                        "type": "string",
                        "example": "-41.201 -59.8371"
                    },
                    "license_plate": {
                        "description": "Гос. Номер ТС",
                        "type": "string",
                        "example": "А999МР 179"
                    },
                    "price_at_minute": {
                        "description": "Цена в копейках за минуту аренды ТС",
                        "type": "integer",
                        "example": "400000"
                    }
                },
                "type": "object"
            },
            "VehicleBrandResourse": {
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": "1"
                    },
                    "vehicle_manufacturer_id": {
                        "type": "integer",
                        "example": "1"
                    },
                    "name": {
                        "type": "string",
                        "example": "Audi"
                    }
                },
                "type": "object"
            },
            "VehicleManufacturerResourse": {
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": "1"
                    },
                    "name": {
                        "type": "string",
                        "example": "VAG"
                    }
                },
                "type": "object"
            },
            "VehicleResourse": {
                "properties": {
                    "id": {
                        "type": "string",
                        "format": "uuid",
                        "example": "989bdecd-cd8a-4aae-96d7-1d1ce023f543"
                    },
                    "vehicle_model_id": {
                        "type": "integer",
                        "example": "4"
                    },
                    "status": {
                        "type": "integer",
                        "example": "rented"
                    },
                    "mileage": {
                        "type": "integer",
                        "example": "110"
                    },
                    "manufacture_year": {
                        "type": "integer",
                        "example": "2019"
                    },
                    "price_at_minute": {
                        "type": "integer",
                        "example": "90000"
                    }
                },
                "type": "object"
            }
        }
    }
}